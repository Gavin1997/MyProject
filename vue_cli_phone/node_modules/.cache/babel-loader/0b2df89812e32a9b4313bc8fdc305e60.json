{"remainingRequest":"C:\\Users\\web\\Desktop\\vue_app_00\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\web\\Desktop\\vue_app_00\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\web\\Desktop\\vue_app_00\\src\\components\\subcomponents\\comment.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\web\\Desktop\\vue_app_00\\src\\components\\subcomponents\\comment.vue","mtime":1540455706910},{"path":"C:\\Users\\web\\Desktop\\vue_app_00\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1534853417988},{"path":"C:\\Users\\web\\Desktop\\vue_app_00\\node_modules\\babel-loader\\lib\\index.js","mtime":1529635966000},{"path":"C:\\Users\\web\\Desktop\\vue_app_00\\node_modules\\vue-loader\\lib\\index.js","mtime":1527860006000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.promise\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { Toast } from \"mint-ui\";\nimport Qs from \"qs\";\nimport { MessageBox } from \"mint-ui\";\nexport default {\n  inject: ['reload'],\n  data: function data() {\n    return {\n      list: [],\n      pageIndex: 0,\n      //当前显示页码\n      msg: \"\"\n    };\n  },\n  methods: {\n    submitMsg: function submitMsg() {\n      var _this = this;\n\n      //  console.log(this.list)\n      var username = \"匿名用户\";\n      var nid = this.id; //新闻编号\n\n      var content = this.msg; //双想绑定留言的内容\n\n      var url = \"newslist/saveComment\";\n      var obj = {\n        nid: nid,\n        content: content,\n        username: username\n      };\n      this.$axios.post(url, Qs.stringify(obj)).then(function (result) {\n        // console.log(result);\n        if (result.data.code == 1) {\n          _this.msg = \"\";\n          Toast(result.data.msg);\n          _this.pageIndex = 0;\n          _this.list = [];\n\n          _this.getMore();\n        } else if (result.data.code == -1) {\n          var msg = result.data.msg;\n          Toast({\n            message: msg,\n            duration: 1200\n          });\n        } else {\n          Toast({\n            message: result.data.msg,\n            duration: 1500\n          });\n        }\n      }); //  this.list.unshift({content:this.str,id:1,username:\"weigong\",citme:new Date().toLocaleString()})\n    },\n    getMore: function getMore() {\n      var _this2 = this;\n\n      this.pageIndex++; //页码加一\n\n      this.$axios.get(\"newslist/commentlist?nid=\" + this.id + \"&pno=\" + this.pageIndex).then(function (res) {\n        _this2.list = _this2.list.concat(res.data.data);\n        console.log(res.data);\n        var len = res.data.data + res.data.pageSize;\n\n        if (_this2.list.length > len) {\n          // console.log(len+res.data.data.length)\n          Toast({\n            message: \"没有更多了\",\n            duration: 800\n          });\n        }\n      });\n    },\n    delMsg: function delMsg(id) {\n      var _this3 = this;\n\n      MessageBox.confirm(\"确定要删除这条评论吗?\").then(function () {\n        _this3.$axios.get(\"newslist/delComment?id=\" + id).then(function (res) {\n          if (res.data.code == 1) {\n            Toast({\n              message: res.data.msg,\n              duartion: 1000\n            });\n          } else {\n            Toast({\n              message: res.data.msg,\n              duartion: 1000\n            });\n          }\n\n          _this3.reload();\n        });\n      }).catch(function (v) {\n        console.info(v);\n      });\n    }\n  },\n  watch: {},\n  created: function created() {\n    this.getMore();\n  },\n  props: [\"id\"] //接受父组件的传递参数\n\n};",{"version":3,"sources":["comment.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAwBA,SACA,KADA,QAEA,SAFA;AAGA,OAAA,EAAA,MAAA,IAAA;AACA,SAAA,UAAA,QAAA,SAAA;AACA,eAAA;AACA,UAAA,CAAA,QAAA,CADA;AAEA,MAFA,kBAEA;AACA,WAAA;AACA,YAAA,EADA;AAEA,iBAAA,CAFA;AAEA;AACA,WAAA;AAHA,KAAA;AAKA,GARA;AASA,WAAA;AACA,aADA,uBACA;AAAA;;AACA;AACA,UAAA,WAAA,MAAA;AACA,UAAA,MAAA,KAAA,EAAA,CAHA,CAGA;;AACA,UAAA,UAAA,KAAA,GAAA,CAJA,CAIA;;AACA,UAAA,MAAA,sBAAA;AACA,UAAA,MAAA;AACA,gBADA;AAEA,wBAFA;AAGA;AAHA,OAAA;AAKA,WAAA,MAAA,CAAA,IAAA,CAAA,GAAA,EAAA,GAAA,SAAA,CAAA,GAAA,CAAA,EAAA,IAAA,CAAA,kBAAA;AACA;AACA,YAAA,OAAA,IAAA,CAAA,IAAA,IAAA,CAAA,EAAA;AACA,gBAAA,GAAA,GAAA,EAAA;AACA,gBAAA,OAAA,IAAA,CAAA,GAAA;AACA,gBAAA,SAAA,GAAA,CAAA;AACA,gBAAA,IAAA,GAAA,EAAA;;AACA,gBAAA,OAAA;AACA,SANA,MAMA,IAAA,OAAA,IAAA,CAAA,IAAA,IAAA,CAAA,CAAA,EAAA;AACA,cAAA,MAAA,OAAA,IAAA,CAAA,GAAA;AACA,gBAAA;AACA,qBAAA,GADA;AAEA,sBAAA;AAFA,WAAA;AAIA,SANA,MAMA;AACA,gBAAA;AACA,qBAAA,OAAA,IAAA,CAAA,GADA;AAEA,sBAAA;AAFA,WAAA;AAIA;AACA,OApBA,EAXA,CAiCA;AACA,KAnCA;AAoCA,WApCA,qBAoCA;AAAA;;AACA,WAAA,SAAA,GADA,CACA;;AACA,WAAA,MAAA,CACA,GADA,CACA,8BAAA,KAAA,EAAA,GAAA,OAAA,GAAA,KAAA,SADA,EAEA,IAFA,CAEA,eAAA;AACA,eAAA,IAAA,GAAA,OAAA,IAAA,CAAA,MAAA,CAAA,IAAA,IAAA,CAAA,IAAA,CAAA;AACA,gBAAA,GAAA,CAAA,IAAA,IAAA;AACA,YAAA,MAAA,IAAA,IAAA,CAAA,IAAA,GAAA,IAAA,IAAA,CAAA,QAAA;;AACA,YAAA,OAAA,IAAA,CAAA,MAAA,GAAA,GAAA,EAAA;AACA;AACA,gBAAA;AACA,qBAAA,OADA;AAEA,sBAAA;AAFA,WAAA;AAIA;AACA,OAbA;AAcA,KApDA;AAqDA,UArDA,kBAqDA,EArDA,EAqDA;AAAA;;AACA,iBAAA,OAAA,CAAA,aAAA,EAAA,IAAA,CAAA,YAAA;AACA,eAAA,MAAA,CAAA,GAAA,CAAA,4BAAA,EAAA,EAAA,IAAA,CAAA,eAAA;AACA,cAAA,IAAA,IAAA,CAAA,IAAA,IAAA,CAAA,EAAA;AACA,kBAAA;AACA,uBAAA,IAAA,IAAA,CAAA,GADA;AAEA,wBAAA;AAFA,aAAA;AAIA,WALA,MAKA;AACA,kBAAA;AACA,uBAAA,IAAA,IAAA,CAAA,GADA;AAEA,wBAAA;AAFA,aAAA;AAIA;;AACA,iBAAA,MAAA;AACA,SAbA;AAcA,OAfA,EAeA,KAfA,CAeA,aAAA;AACA,gBAAA,IAAA,CAAA,CAAA;AACA,OAjBA;AAmBA;AAzEA,GATA;AAqFA,SAAA,EArFA;AAsFA,SAtFA,qBAsFA;AACA,SAAA,OAAA;AACA,GAxFA;AAyFA,SAAA,CAAA,IAAA,CAzFA,CAyFA;;AAzFA,CAAA","sourcesContent":["<template>\r\n  <div class=\"app_subcomment\">\r\n    <div>\r\n      <textarea class=\"textarea\" placeholder=\"请输入评论的内容(最多吐槽120字)\" maxlength=\"120\" v-model=\"msg\"></textarea>\r\n      <mt-button type=\"primary\" size=\"large\" class=\"button\" @click.native=\"submitMsg()\">点击发表评论</mt-button>\r\n    </div>\r\n    <!-- 评论区 -->\r\n    <div class=\"comment\">\r\n      <ul>\r\n        <li v-for=\"(item,i) in list\" :key=\"i\">\r\n          <span>第{{i+1}}楼</span>\r\n          <span>{{item.content | ellipse(123)}}</span>\r\n          <span>{{item.username}}</span>\r\n          <span>{{item.ctime | dateFormat}}</span>\r\n          <p>\r\n            <mt-button type=\"danger\" size=\"small\" @click.native=\"delMsg(item.id)\">删除</mt-button>\r\n          </p>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n    <mt-button type=\"primary\" size=\"large\" @click=\"getMore()\">加载更多....</mt-button>\r\n  </div>\r\n</template>\r\n<script>\r\n  import {\r\n    Toast\r\n  } from \"mint-ui\";\r\n  import Qs from \"qs\";\r\n  import { MessageBox} from \"mint-ui\";\r\n  export default {\r\n    inject:['reload'],\r\n    data() {\r\n      return {\r\n        list: [],\r\n        pageIndex: 0, //当前显示页码\r\n        msg: \"\"\r\n      };\r\n    },\r\n    methods: {\r\n      submitMsg() {\r\n        //  console.log(this.list)\r\n        var username = \"匿名用户\";\r\n        var nid = this.id; //新闻编号\r\n        var content = this.msg; //双想绑定留言的内容\r\n        var url = \"newslist/saveComment\";\r\n        var obj = {\r\n          nid,\r\n          content,\r\n          username\r\n        };\r\n        this.$axios.post(url, Qs.stringify(obj)).then(result => {\r\n          // console.log(result);\r\n          if (result.data.code == 1) {\r\n            this.msg = \"\";\r\n            Toast(result.data.msg);\r\n            this.pageIndex = 0;\r\n            this.list = [];\r\n            this.getMore();\r\n          } else if(result.data.code == -1){\r\n            var msg = result.data.msg;\r\n            Toast({\r\n              message: msg,\r\n              duration: 1200\r\n            });\r\n          }else{\r\n            Toast({\r\n              message:result.data.msg,\r\n              duration:1500\r\n            })\r\n          }\r\n        });\r\n\r\n        //  this.list.unshift({content:this.str,id:1,username:\"weigong\",citme:new Date().toLocaleString()})\r\n      },\r\n      getMore() {\r\n        this.pageIndex++; //页码加一\r\n        this.$axios\r\n          .get(\"newslist/commentlist?nid=\" + this.id + \"&pno=\" + this.pageIndex)\r\n          .then(res => {\r\n            this.list = this.list.concat(res.data.data);\r\n            console.log(res.data);\r\n            var len = res.data.data + res.data.pageSize;\r\n            if (this.list.length > len) {\r\n              // console.log(len+res.data.data.length)\r\n              Toast({\r\n                message: \"没有更多了\",\r\n                duration: 800\r\n              });\r\n            }\r\n          });\r\n      },\r\n      delMsg(id){\r\n        MessageBox.confirm(\"确定要删除这条评论吗?\").then(()=>{\r\n          this.$axios.get(\"newslist/delComment?id=\"+id).then(res=>{\r\n              if(res.data.code==1){\r\n                Toast({\r\n                  message:res.data.msg,\r\n                  duartion:1000\r\n                })\r\n              }else{\r\n                Toast({\r\n                  message:res.data.msg,\r\n                  duartion:1000\r\n                })\r\n              }\r\n               this.reload();\r\n          })\r\n        }).catch(v=>{\r\n          console.info(v)\r\n        })\r\n      \r\n      }\r\n     \r\n    },\r\n    watch: {},\r\n    created() {\r\n      this.getMore();\r\n    },\r\n    props: [\"id\"] //接受父组件的传递参数\r\n  };\r\n</script>\r\n<style scoped>\r\n  .app_subcomment div .textarea {\r\n    font-size: 10px !important;\r\n    color: black !important;\r\n    border-radius: 12px;\r\n    scrollbar-arrow-color: yellow;\r\n    scrollbar-base-color: lightsalmon;\r\n    overflow: hidden;\r\n    color: #666464;\r\n    height: auto;\r\n    margin: 0;\r\n  }\r\n\r\n  .app_subcomment div.comment {\r\n    position: relative;\r\n  }\r\n\r\n  .app_subcomment div.comment ul {\r\n    list-style: none;\r\n    padding: 0;\r\n  }\r\n\r\n  .app_subcomment div.comment ul li {\r\n    display: flex;\r\n    justify-content: space-around;\r\n    width: 100%;\r\n    border: 1px solid #6464;\r\n    border-radius: 5px;\r\n    background: #fff;\r\n    height: auto;\r\n    text-align: center;\r\n    margin-top: 2px;\r\n\r\n  }\r\n\r\n  .app_subcomment div.comment ul li span {\r\n    display: inline-block;\r\n    padding: 5px;\r\n    font-size: 12px;\r\n  }\r\n\r\n  .app_subcomment div.comment ul li span:first-child {\r\n    background-color: #eee;\r\n  }\r\n</style>"],"sourceRoot":"src\\components\\subcomponents"}]}