{"remainingRequest":"c:\\Users\\web\\Desktop\\MyProject\\04_vue_cli_phone\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!c:\\Users\\web\\Desktop\\MyProject\\04_vue_cli_phone\\src\\components\\goods\\GoodsInfo.vue?vue&type=style&index=0&id=66f49584&scoped=true&lang=css","dependencies":[{"path":"c:\\Users\\web\\Desktop\\MyProject\\04_vue_cli_phone\\src\\components\\goods\\GoodsInfo.vue","mtime":1542016595032},{"path":"c:\\Users\\web\\Desktop\\MyProject\\04_vue_cli_phone\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"c:\\Users\\web\\Desktop\\MyProject\\04_vue_cli_phone\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1540554614000},{"path":"c:\\Users\\web\\Desktop\\MyProject\\04_vue_cli_phone\\node_modules\\postcss-loader\\lib\\index.js","mtime":1540554614000},{"path":"c:\\Users\\web\\Desktop\\MyProject\\04_vue_cli_phone\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1540554614000},{"path":"c:\\Users\\web\\Desktop\\MyProject\\04_vue_cli_phone\\node_modules\\vue-loader\\lib\\index.js","mtime":1540554614000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.old {\n  text-decoration: line-through;\n}\n\n.love_active {\n  background: #EF4F4F !important;\n  color: #fff;\n}\n\n.price .now {\n  color: #ff7467;\n  font-weight: 600;\n  margin-left: 10px;\n}\n\n.number {\n  display: inline-block;\n  width: 32px;\n  height: 32px;\n  text-align: center;\n  line-height: 32px;\n}\n\n.booking {\n  margin-top: 8px;\n}\n\n/*参数*/\n.product_info_details {\n  background: #fff;\n}\n\nul.info-list {\n  list-style: none;\n  padding: 10px;\n  margin-bottom: 5px;\n  margin-top: 8px;\n}\n\n.info-list li {\n  font-size: 12px;\n  color: #666;\n  padding: 5px 0;\n  letter-spacing: 1px;\n  border-bottom: 1px solid #ddd;\n}\n\ndiv.intro {\n  display: flex !important;\n  width: 100%;\n  justify-content: space-between;\n  padding: 10px;\n}\n\n.intro-img {\n  width: 100%;\n}\n\n.intro-img img {\n  width: 100%;\n\n}\n",{"version":3,"sources":["GoodsInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+QA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA","file":"GoodsInfo.vue","sourceRoot":"src\\components\\goods","sourcesContent":["<template>\n  <!-- 轮播 -->\n  <div>\n    <div class=\"app-goods-info\">\n      <div class=\"mui-card\">\n        <div class=\"mui-card-content\">\n          <div class=\"mui-card-content-inner\">\n            <mt-swipe :auto=\"3000\" style=\"height:200px;\">\n              <mt-swipe-item v-for=\"(item,i) in imgList\" :key=\"item.id\">\n                <img :src=\"item.md\" alt=\"\" style=\"width:100%\">\n              </mt-swipe-item>\n            </mt-swipe>\n          </div>\n        </div>\n      </div>\n      <!-- 第二部分购买区域 -->\n\n      <div class=\"mui-card\">\n        <div class=\"mui-card-header\">{{products.title}}</div>\n        <div class=\"mui-card-content\">\n          <div class=\"mui-card-content-inner\">\n            <div class=\"details\">{{products.title}}</div>\n            <div class=\"price\">\n              <b>市场价: </b>\n              <span class=\"old\">{{(Number(products.price)).toFixed(2)}}</span>\n              <span class=\"now\">销售价:{{(Number(products.price)).toFixed(2)}}</span>\n            </div>\n            <div class=\"count\">\n              <h6>购买数量</h6>\n              <mt-button size=\"small\" @click=\"goSub()\">-</mt-button>\n              <span class=\"number\">{{count}}</span>\n              <mt-button size=\"small\" @click=\"goAdd()\">+</mt-button>\n\n              <p class=\"booking\">\n                <mt-button size=\"small\" type=\"primary\">立即购买</mt-button>\n                <mt-button size=\"small\" type=\"default\" :class=\"{love_active:iscollection}\" @click=\"addCart()\">收藏</mt-button>\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n      <!-- 第三部分 -->\n      <div class=\"mui-card\">\n        <div class=\"mui-card-header\">商品参数</div>\n        <div class=\"mui-card-content\">\n          <div class=\"mui-card-content-inner\">\n            <div>\n              <ul class=\"info-list\">\n                <li>商品货号:{{products.product_number}}</li>\n                <li>商品特色:{{products.subtitle}}</li>\n                <li>我们承诺:{{products.promise}}</li>\n                <li>注意事项:{{products.prompt}}</li>\n              </ul>\n            </div>\n          </div>\n          <div class=\"mui-card-footer\">\n            <div class=\"intro\">\n              <p>\n                <mt-button size=\"small\" @click=\"show_lgImg()\">图文介绍</mt-button>\n              </p>\n              <p>\n                <mt-button size=\"small\" @click=\"show_comment()\">商品评论</mt-button>\n              </p>\n            </div>\n          </div>\n          <div class=\"intro-img\" v-if=\"ifshow_lgImg\">\n            <img :src=\"products.lg_pic\" alt=\"\">\n          </div>\n    \t<div class=\"mui-content\" v-if=\"ifshow_comment\">\n\t\t    <ul class=\"mui-table-view mui-table-view-striped mui-table-view-condensed\">\n\t\t        <li class=\"mui-table-view-cell\" v-for=\"(item,i) in CommentList\" :key=\"i\">\n\t\t            <div class=\"mui-table\">\n\t\t                <div class=\"mui-table-cell mui-col-xs-10\">\n\t\t                    <h4 class=\"mui-ellipsis-2\" style=\"font-size:13px;\">{{item.content}}</h4>\n\t\t                    <h5>用户：{{item.uname}}</h5>\n\t\t                    <p class=\"mui-h6 mui-ellipsis\">{{item.ctime | dateFormat}}</p>\n\t\t                </div>\n\t\t               \n\t\t            </div>\n\t\t        </li>\n\t\t    </ul>\n\t\t</div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\n  import swiper from \"../subcomponents/swiper\";\n  import Qs from \"qs\";\n  import {\n    Toast\n  } from \"mint-ui\";\n  // 由于mui'.js与脚手架严格模式有冲突 放弃\n  // import mui from \"../../lib/mui/js/mui.js\";\n  export default {\n    inject: ['reload'],\n    data() {\n      return {\n        count: 1,\n        tid: this.$route.params.id,\n        list: [],\n        md: [],\n        imgList: [],\n        products: [],\n        ifshow_lgImg: false,\n        islogin: false,\n        uname: \"\", //当前登录的用户名\n        uid: \"\", //当前用户的uid\n        iscollection: false,\n        CommentList: [], //商苹评论列表\n        ifshow_comment:false //是否显示评论内容\n      };\n    },\n    methods: {\n      //1. 加入购物车\n      addCart() { \n        var tid = this.products.tid;\n        var title = this.products.title;\n        var count = this.count;\n        var price = this.products.price;\n        var md_pic = this.md;\n        var subtitle = this.products.subtitle;\n        var old_price = this.products.old_price;\n        var sold_count = this.products.sold_count;\n        var uid = this.uid;\n        var uname = this.uname;\n        // console.log(title,subtitle,price,old_price,sold_count,md_pic,tid,uid,uname)\n        var obj = {\n          title,\n          subtitle,\n          price,\n          old_price,\n          sold_count,\n          md_pic,\n          tid,\n          uid,\n          uname\n        };\n        var url = \"/collection/add\";\n        var obj = (Qs.stringify(obj));\n        \n        if (this.isLogin == false) {\n          this.$router.push({\n            path: \"/home/users/login\",\n            query:{redirect:`/home/goodsinfo/${this.tid}`}\n          });\n          return;\n        }\n        if (this.isLogin == true) {\n          //如果当前图标不为高亮状态 \n          if (this.iscollection == false) {\n            //发送请求 添加数据到数据库\n            this.$axios\n              .post(\n                url,\n                obj\n              )\n              .then(res => {\n                if (res.data.code == 1) {\n                  this.iscollection = true;\n                  Toast({\n                    message: \"加入收藏列表成功\",\n                    duration: 1500\n                  })\n                } else {\n                  Toast({\n                    message: \"加入收藏列表失败,请刷新一下试试\",\n                    duration: 1500\n                  })\n                }\n              });\n          } else {\n            //删除功能\n            this.$axios\n              .post(\n                \"/collection/delete\",\n                Qs.stringify({\n                  tid: this.tid\n                })\n              )\n              .then(res => {\n                if (res.data.code == 1) {\n                  Toast({\n                    message: \"删除成功\",\n                    duration: 1500\n                  })\n                  this.iscollection = false;\n                }\n              });\n          }\n            this.$store.dispatch(\"saveForm\");\n        }\n      },\n      //2. 商品数量+1\n      goSub() {\n        if (this.count <= 1) {\n          return\n        };\n        this.count = this.count - 1;\n      },\n      goAdd() {\n        if (this.count >= 99) {\n          return\n        };\n        this.count = this.count + 1;\n      },\n      //是否展示图文详情\n      show_lgImg() {\n        if (this.ifshow_lgImg === false) {\n          this.ifshow_lgImg = true;\n        } else {\n          this.ifshow_lgImg = false;\n        }\n      },\n      // 是否显示评论详情\n      show_comment() {\n        if (this.ifshow_comment === false) {\n          this.ifshow_comment = true;\n        } else {\n          this.ifshow_comment = false;\n        }\n      },\n      loadMore() {\n        this.loading = true;\n        setTimeout(() => {\n          let last = this.list[this.list.length - 1];\n          for (let i = 1; i <= 10; i++) {\n            this.list.push(last + i);\n          }\n          this.loading = false;\n        }, 2500);\n      }\n      \n    },\n    created() {\n      (async function (self) {\n        //1.判断是否登录\n        var res = await self.$axios.get(\"/users/islogin\")\n        if (res.data.ok == 1) {\n          self.isLogin = true;\n          self.uname = res.data.uname;\n          self.uid = res.data.uid;\n        } else {\n          self.isLogin = false;\n        }\n        //2.判断当前产品是否被当前用户收藏\n        var res = await self.$axios.get(`/collection/iscollection?uname=${self.uname}&tid=${self.tid}`)\n        if (res.data.code == 1) {\n          self.iscollection = true;\n        } else {\n          self.iscollection = false;\n        }\n      })(this);\n      // 3. 获取商品详情页\n      this.$axios.get(\"details?tid=\" + this.tid).then(res => {\n        this.products = res.data.product;\n        this.imgList = res.data.pics;\n        this.md = res.data.pics[0].md;\n      });\n      //4. 获取商品评论列表\n      this.$axios.get(\"comment/searchcomment?tid=\" + this.tid).then(res => {\n        this.CommentList = res.data.obj.comments;\n      });\n    },\n    components: {\n      swiper\n    }\n  };\n</script>\n<style scoped>\n  .old {\n    text-decoration: line-through;\n  }\n\n  .love_active {\n    background: #EF4F4F !important;\n    color: #fff;\n  }\n\n  .price .now {\n    color: #ff7467;\n    font-weight: 600;\n    margin-left: 10px;\n  }\n\n  .number {\n    display: inline-block;\n    width: 32px;\n    height: 32px;\n    text-align: center;\n    line-height: 32px;\n  }\n\n  .booking {\n    margin-top: 8px;\n  }\n\n  /*参数*/\n  .product_info_details {\n    background: #fff;\n  }\n\n  ul.info-list {\n    list-style: none;\n    padding: 10px;\n    margin-bottom: 5px;\n    margin-top: 8px;\n  }\n\n  .info-list li {\n    font-size: 12px;\n    color: #666;\n    padding: 5px 0;\n    letter-spacing: 1px;\n    border-bottom: 1px solid #ddd;\n  }\n\n  div.intro {\n    display: flex !important;\n    width: 100%;\n    justify-content: space-between;\n    padding: 10px;\n  }\n\n  .intro-img {\n    width: 100%;\n  }\n\n  .intro-img img {\n    width: 100%;\n\n  }\n</style>"]}]}